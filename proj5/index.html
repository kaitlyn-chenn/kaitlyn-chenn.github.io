<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>COMPSCI 180 Project 5:  Fun with Diffusion Models! </title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 1200px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="142fb006-dea9-8029-818c-c2947148d8e0" class="page serif"><header><h1 class="page-title">COMPSCI 180 Project 5:  Fun with Diffusion Models! </h1><p class="page-description"></p></header><div class="page-body"><p id="142fb006-dea9-80a2-8330-cbff29b778cf" class="">Kaitlyn Chen</p><h2 id="142fb006-dea9-8047-b765-c1d2c7272f09" class="">Introduction: </h2><p id="143fb006-dea9-809b-82fb-c3f6bd7952d7" class="block-color-gray_background">The goal of this project is to generate images using diffusion models. In part A of this project we experiment with a pretrained a text-to-image diffusion model (DeepFloyd IF model) to implement diffusion sampling loops for inpainting and creating optical illusions. In part B we train our own diffusion model on MNIST dataset to create images of MNIST digits. </p><h2 id="144fb006-dea9-8091-b1ca-ee8b8bf98fb1" class="">Part A: </h2><h2 id="144fb006-dea9-8023-bb55-c391079e2d0f" class=""><strong>Part 0: Setup: </strong></h2><div id="144fb006-dea9-8018-8a19-fbeff63f5262" class="column-list"><div id="144fb006-dea9-80b8-9684-cdb261d90f49" style="width:31.25%" class="column"><p id="144fb006-dea9-8088-b0a5-fbc277d61f74" class="block-color-gray_background">We first instantiate DeepFloyd&#x27;s <code>stage_1</code> and <code>stage_2</code> objects used for generation, as well as several text prompts for sample generation. To the right are 3 text prompts used as inputs and their respective image outputs.  I ran the model twice with different num_inference_steps, which tells how many denoising steps to take. The top three images are with  num_inference_steps = 20, and the bottom three are with num_inference_steps = 100. <br/>With 100 inference steps the images are more detailed and clearer. <br/></p><p id="144fb006-dea9-803c-be82-f88a08ca0610" class="">
</p></div><div id="144fb006-dea9-805f-98fe-e572f7042654" style="width:68.75%" class="column"><figure id="142fb006-dea9-8039-bed7-d6e6e2502ff6" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/Screen_Shot_2024-11-17_at_7.01.03_PM.png"><img style="width:768px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/Screen_Shot_2024-11-17_at_7.01.03_PM.png"/></a><figcaption>with num_inference_steps = 20</figcaption></figure><figure id="142fb006-dea9-801a-8d5b-cf7862148cd8" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/Screen_Shot_2024-11-17_at_7.01.25_PM.png"><img style="width:768px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/Screen_Shot_2024-11-17_at_7.01.25_PM.png"/></a><figcaption>with num_inference_steps = 100</figcaption></figure></div></div><h2 id="144fb006-dea9-8045-963e-fbfc4353abc0" class=""><strong>Part 1: Sampling Loops</strong></h2><p id="144fb006-dea9-80f5-93b2-c5a07d1bb65c" class="block-color-gray_background">In this section we write our own “sampling loops” pretrained using DeepFloyd denoisers. A diffusion model, given a noisy model,  predicts the noise in an image at timestep. This can be used to generate images from pure noise. Continuously predicting the noise at a time step t then removing part of the noise give us a less noisy image at t-1 until we arrive at a clean image. T is used to denoise timestep with pure noise, and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\bar\alpha_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7178em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> In DeepFloyd models, T=1000. </p><h2 id="144fb006-dea9-809c-844e-c7bc394ee621" class=""><strong>1.1 Implementing the Forward Process</strong></h2><p id="144fb006-dea9-808a-9cc8-ef53527c525a" class="block-color-gray_background">The forward process of diffusion is adding noise to a clean image and scaling. The equivalent functions below define it: </p><figure id="144fb006-dea9-800a-9a4b-e7e67331dda8" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/Screen_Shot_2024-11-19_at_7.27.44_PM.png"><img style="width:336px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/Screen_Shot_2024-11-19_at_7.27.44_PM.png"/></a></figure><figure id="144fb006-dea9-80e4-a9ff-e18e5b74afac" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/Screen_Shot_2024-11-19_at_7.27.53_PM.png"><img style="width:432px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/Screen_Shot_2024-11-19_at_7.27.53_PM.png"/></a></figure><p id="144fb006-dea9-80b1-a1fa-ea663b6c7045" class="block-color-gray_background">where <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is the input clean image, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is the noisy image at timetep t, sampled from a Gaussian with mean<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\sqrt{\bar\alpha_t}x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.2461em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7939em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7539em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2461em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and variance <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(1 - \bar\alpha_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>.  <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\bar\alpha_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7178em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is given for all t. I utilized the function torch.randn_like to compute the noise. <br/>Results from running the forward process on campanile image (resized to 64x64) with <br/><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>250</mn><mo separator="true">,</mo><mn>500</mn><mo separator="true">,</mo><mn>750</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">t \in [250, 500, 750]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6542em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">250</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">500</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">750</span><span class="mclose">]</span></span></span></span></span><span>﻿</span></span>: </p><div id="142fb006-dea9-8088-9337-ef9182f8c0ec" class="column-list"><div id="142fb006-dea9-80da-ba9e-f24909e5b4ca" style="width:25%" class="column"><figure id="142fb006-dea9-80bd-9dbd-cfeed80f4963" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image.png"><img style="width:528px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image.png"/></a></figure></div><div id="142fb006-dea9-8002-9077-c0b9649cfc26" style="width:25.00000000000001%" class="column"><figure id="142fb006-dea9-805e-90cd-f713ec5729e5" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%201.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%201.png"/></a></figure></div><div id="144fb006-dea9-8002-bcd4-c8da3334da30" style="width:25.000000000000007%" class="column"><figure id="142fb006-dea9-80ca-a6bc-f125b54cb8e8" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%202.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%202.png"/></a></figure></div><div id="144fb006-dea9-804d-b79d-c4405cfec6e5" style="width:25%" class="column"><figure id="142fb006-dea9-80f4-90ac-eae0dcccf78b" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%203.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%203.png"/></a></figure></div></div><h2 id="144fb006-dea9-8010-be61-f22b845b7e70" class=""><strong>1.2 Classical Denoising</strong></h2><p id="144fb006-dea9-80be-9f3a-fdb6a36203ee" class="block-color-gray_background">Now we denoise the campanile image with Gaussian blur filtering. I used the function torchvision.transforms.functional.gaussian_blur with kernel size 5 and sigma 2. </p><div id="142fb006-dea9-80d7-b7f8-cdd80d8d0c57" class="column-list"><div id="142fb006-dea9-80fc-87c9-d94d849a0fb1" style="width:25.00000000000001%" class="column"><figure id="142fb006-dea9-807a-a531-f6f26029886a" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image.png"><img style="width:576px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image.png"/></a></figure></div><div id="144fb006-dea9-80f1-a6c8-c4ec3ddd8858" style="width:25.000000000000007%" class="column"><figure id="142fb006-dea9-801c-a13c-f0ceb5aa2303" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%204.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%204.png"/></a></figure></div><div id="142fb006-dea9-802d-8069-e92375069aae" style="width:25.00000000000001%" class="column"><figure id="142fb006-dea9-80f7-b75c-eea88141ea02" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%205.png"><img style="width:480px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%205.png"/></a></figure></div><div id="144fb006-dea9-801f-805b-e461cee60dc9" style="width:25.000000000000007%" class="column"><figure id="142fb006-dea9-801b-9f16-ce184fac0c82" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%206.png"><img style="width:382.6649475097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%206.png"/></a></figure></div></div><h2 id="144fb006-dea9-80c3-aea6-ec69b9487886" class=""><strong>1.3 One-Step Denoising</strong></h2><p id="144fb006-dea9-80ac-8a43-dd17229d786f" class="block-color-gray_background">Now we use a pretrianed diffusion model to denoise. The denoiser is<code>stage_1.unet</code> that has already been trained on a large data set of <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_0, x_t) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> paris of images. We use this model to recover Gaussian noise and then remove the noise to get something close to the orignal campanile image.  the model was trained on text so we used the previously downloaded text prompt embedding, and use the prompt “a high quality photo” which acts as a null prompt. <br/><br/>For the three noisy images generated from previously, I first denoise the image by estimating the noise with UNet. Then pass this through stage_1.unet to estimate the noise in a new noisy image. I then remove the noise from the noisy image to obtain an estimate of the original image. Visualizations of the results of each step: <br/></p><div id="142fb006-dea9-8076-b059-ff881ad4916b" class="column-list"><div id="142fb006-dea9-806d-9d24-d13e7515e259" style="width:25.000000000000007%" class="column"><figure id="142fb006-dea9-8010-9f0d-dcc35c1be941" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image.png"><img style="width:528px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image.png"/></a></figure><p id="144fb006-dea9-8064-8d57-e4500c856dd4" class="">
</p></div><div id="144fb006-dea9-80b5-ba4b-c410a1bc4aec" style="width:25.000000000000007%" class="column"><figure id="144fb006-dea9-8012-a024-de53e75404a5" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%201.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%201.png"/></a></figure><figure id="142fb006-dea9-802f-afaf-e6388b94c86e" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%207.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%207.png"/></a></figure></div><div id="144fb006-dea9-8084-9574-d90cc3bdd332" style="width:25.000000000000007%" class="column"><figure id="144fb006-dea9-8068-9161-dc1e780d8877" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%202.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%202.png"/></a></figure><figure id="142fb006-dea9-8035-8b1b-fe5f1ac9547c" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%208.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%208.png"/></a></figure></div><div id="142fb006-dea9-8017-b00a-c653a0291370" style="width:25.000000000000007%" class="column"><figure id="144fb006-dea9-8079-8c1b-c162598a31cb" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%203.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%203.png"/></a></figure><figure id="142fb006-dea9-80ce-b944-ff07fe893073" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%209.png"><img style="width:275.4861145019531px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%209.png"/></a></figure></div></div><h2 id="144fb006-dea9-8084-8f5c-c17d0066ca4e" class=""><strong>1.4 Iterative Denoising</strong></h2><p id="144fb006-dea9-8099-8917-d58463450020" class="block-color-gray_background">We can see that One-Step denoising from the previous steps actually produces “worse” images with more noise. Diffusion models should denoise iteratively, instead of at defined timesteps t, so in this section we do so. Denoising at all 1000 timesteps would be slow and computationally expensive, so instead we skip steps and turns out it works well. We essentially create a longer list of timesteps called <code>strided_timesteps</code> with strides of size 30. So when we are at the ith denoising step we are at t=strided_timesteps[i] and produce a less noisy t’=strided_timesteps[i+1]. We use the equation: <br/><br/></p><div id="144fb006-dea9-8081-9243-ddf7997c7a91" class="column-list"><div id="144fb006-dea9-80d4-8eab-f96957962c7b" style="width:43.75%" class="column"><p id="144fb006-dea9-8086-a2cd-e4cc5ff619fd" class="">
</p><figure id="144fb006-dea9-809e-b2be-e2931071f9b5" class="image" style="text-align:right"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/Screen_Shot_2024-11-19_at_8.12.22_PM.png"><img style="width:480px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/Screen_Shot_2024-11-19_at_8.12.22_PM.png"/></a></figure><p id="144fb006-dea9-8033-b736-d4066d8815f6" class="">
</p></div><div id="144fb006-dea9-8037-a596-fd5550b3a8d0" style="width:56.25%" class="column"><ul id="144fb006-dea9-809b-88ce-c810b6e91273" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is your image at timestep 𝑡</li></ul><ul id="144fb006-dea9-807e-a6c4-f8bc60c97d5d" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><msup><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">xt&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is your noisy image at timestep  t’ where 𝑡′&lt;𝑡 (less noisy) </li></ul><ul id="144fb006-dea9-80f6-812d-edb3a7f5c679" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\bar\alpha_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7178em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is defined by <code>alphas_cumprod</code>, as explained above.</li></ul><ul id="144fb006-dea9-808b-b175-dd91b7277580" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> = <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub><mi mathvariant="normal">/</mi><msubsup><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">\bar\alpha_t/\bar\alpha_t&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-2.453em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></li></ul><ul id="144fb006-dea9-8017-b111-de8cdd11c731" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>t</mi></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>α</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\beta_t = 1-\alpha_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0528em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></li></ul><ul id="144fb006-dea9-80c4-9e1e-ccb08f44745c" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is our current estimate of the clean image</li></ul><ul id="144fb006-dea9-8005-9668-ef37834b2e53" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>σ</mi></msub></mrow><annotation encoding="application/x-tex">v_\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">σ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is variance which will be defined by a add_variance function provided by staff</li></ul></div></div><div id="143fb006-dea9-807e-92e8-ed252b42ade7" class="column-list"><div id="143fb006-dea9-8018-a428-cbcbe66a5dfc" style="width:20.00000000000001%" class="column"><figure id="143fb006-dea9-8034-88f5-f31b4e7ec803" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2010.png"><img style="width:211.18923950195312px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2010.png"/></a></figure></div><div id="143fb006-dea9-804f-9c09-e0bb46cfd738" style="width:20%" class="column"><figure id="143fb006-dea9-8007-848c-d7f40ff1cac0" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2011.png"><img style="width:211.18923950195312px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2011.png"/></a></figure></div><div id="143fb006-dea9-8090-abb1-d4e08c369e73" style="width:20.00000000000001%" class="column"><figure id="143fb006-dea9-8079-82d1-cada3d0a0c13" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2012.png"><img style="width:211.18923950195312px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2012.png"/></a></figure></div><div id="143fb006-dea9-8085-9811-d55828ac68ed" style="width:20%" class="column"><figure id="143fb006-dea9-8068-aed7-d06d70466174" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2013.png"><img style="width:211.18923950195312px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2013.png"/></a></figure></div><div id="143fb006-dea9-80bb-b8f3-e3c6896802bf" style="width:20.00000000000001%" class="column"><figure id="143fb006-dea9-80c3-a8c2-c06e40f73db3" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2014.png"><img style="width:211.18923950195312px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2014.png"/></a></figure></div></div><div id="143fb006-dea9-808c-8008-e89953ce4cb2" class="column-list"><div id="143fb006-dea9-8035-9ba7-c669ffe09753" style="width:25%" class="column"><figure id="143fb006-dea9-80f6-b6de-dbf90cf74b68" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2015.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2015.png"/></a></figure></div><div id="143fb006-dea9-80d6-b7da-f6a68e903607" style="width:25%" class="column"><figure id="143fb006-dea9-80ba-983a-dc3561a55f4b" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2016.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2016.png"/></a></figure></div><div id="143fb006-dea9-8011-8775-da400103eae4" style="width:25%" class="column"><figure id="143fb006-dea9-809b-b4ff-f3a9d1c59054" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2017.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2017.png"/></a></figure></div><div id="143fb006-dea9-8015-8032-c1e9b2c0d2fc" style="width:25%" class="column"><figure id="143fb006-dea9-8079-809e-f24297883410" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2018.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2018.png"/></a></figure></div></div><h2 id="144fb006-dea9-8069-92c3-fe8516a9ad27" class=""><strong>1.5 Diffusion Model Sampling</strong></h2><p id="144fb006-dea9-806b-8cc7-e2c0dd04efe8" class="block-color-gray_background">We can also generate images from scratch using iterative denoising. we juset set i_start to 0 and pass in random noise to basically denoise pure noise. I use torch.randn(1, 3, 64, 64).half() to generate the noise.<br/><br/>Examples with “a high quality photo” and “a photo of a dog”: <br/></p><div id="143fb006-dea9-8072-aa72-e8729ae15c18" class="column-list"><div id="143fb006-dea9-80c1-91b0-fc3c608cd03d" style="width:20%" class="column"><figure id="143fb006-dea9-80db-b01c-fec17efe7394" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/c7e142c4-15d8-4362-abb8-d4577f1af694.png"><img style="width:288px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/c7e142c4-15d8-4362-abb8-d4577f1af694.png"/></a></figure></div><div id="143fb006-dea9-803c-8d75-cc4044ceeca1" style="width:20%" class="column"><figure id="143fb006-dea9-80cc-934d-e662b06d4b19" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/c2266fa5-4df5-4ed7-8e76-4a3af0f3736f.png"><img style="width:288px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/c2266fa5-4df5-4ed7-8e76-4a3af0f3736f.png"/></a></figure></div><div id="143fb006-dea9-80ea-985f-e33e1d3f5aad" style="width:20%" class="column"><figure id="143fb006-dea9-8067-b14f-c8e956720159" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/d64d9e37-7dba-4f6f-885b-cfd636b2c46a.png"><img style="width:288px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/d64d9e37-7dba-4f6f-885b-cfd636b2c46a.png"/></a></figure></div><div id="143fb006-dea9-800c-b571-e072c362ad80" style="width:20%" class="column"><figure id="143fb006-dea9-80a1-8736-fda988276bd4" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/f148834f-23f0-4dcb-90d7-6653cb66cb51.png"><img style="width:288px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/f148834f-23f0-4dcb-90d7-6653cb66cb51.png"/></a></figure></div><div id="143fb006-dea9-80e5-a0b4-ec635d93acd4" style="width:20%" class="column"><figure id="143fb006-dea9-8043-bdcc-d9172ab14c4b" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/6cc354b8-2c76-47c3-a31d-6f9672c35f9e.png"><img style="width:324.16666666666663px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/6cc354b8-2c76-47c3-a31d-6f9672c35f9e.png"/></a></figure></div></div><h2 id="144fb006-dea9-8006-9a35-ededfa8559a6" class=""><strong>1.6 Classifier-Free Guidance (CFG)</strong></h2><p id="144fb006-dea9-8075-a06d-d2d227997aaf" class="block-color-gray_background">The images from the last step were not great, so we will increase the quality here, although this decreases the variability. We do so with classifier-free guidance. This technique computes a conditional and unconditional noise estimate, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">\epsilon_c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">\epsilon_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>, then compute a noise estimate: <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>=</mo><msub><mi>ϵ</mi><mi>u</mi></msub><mo>+</mo><mi>γ</mi><mo stretchy="false">(</mo><msub><mi>ϵ</mi><mi>c</mi></msub><mo>−</mo><msub><mi>ϵ</mi><mi>u</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\epsilon = \epsilon_u + \gamma
        (\epsilon_c - \epsilon_u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>. <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span></span><span>﻿</span></span> is the strength of CFG where a value greater than 1 results in high quality results. Not sure why though. I created a function iterative_denoise_cfg that is similar to iterative_denoise from part 1.4 except for the noise estimate.  To generate images we will use “” prompt as the null prompt for unconditional guidance for CFG. We run UNet twice for the conditonal prompt embedding and the unconditional. The variance is calculated with just the conditional variance. <br/><br/>5 Images of a “a high quality phot0” with <br/><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span></span><span>﻿</span></span> = 7: </p><div id="143fb006-dea9-80eb-9b80-e8291f5b1919" class="column-list"><div id="143fb006-dea9-8041-a73e-cf4d3e0e1303" style="width:20%" class="column"><figure id="143fb006-dea9-80f5-abd2-d66761dda4a4" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2019.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2019.png"/></a></figure></div><div id="143fb006-dea9-8087-93b2-c18afe168336" style="width:20%" class="column"><figure id="143fb006-dea9-802b-a710-f76bb91cc0c4" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2020.png"><img style="width:389.0017395019531px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2020.png"/></a></figure></div><div id="143fb006-dea9-8049-a107-d1dc298b3c9b" style="width:20%" class="column"><figure id="143fb006-dea9-8080-b36f-ceedabfb145c" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2021.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2021.png"/></a></figure></div><div id="143fb006-dea9-8031-b156-c8f4a3f34b24" style="width:20%" class="column"><figure id="143fb006-dea9-804d-ae53-e285b2619fd7" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2022.png"><img style="width:389.0017395019531px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2022.png"/></a></figure></div><div id="143fb006-dea9-8040-aaf2-d2ae8c91bd7d" style="width:20%" class="column"><figure id="143fb006-dea9-80fb-ab3d-cecc31372dcb" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2023.png"><img style="width:389.0017395019531px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2023.png"/></a></figure></div></div><h2 id="144fb006-dea9-807e-83d8-f4de2a9f0b04" class=""><strong>1.7 Image-to-image Translation</strong></h2><p id="144fb006-dea9-8060-83c3-ebcc0a272203" class="block-color-gray_background">In this section we are going to use an image similar to the test image with low noise. This follows the SDEdit algorithm. I first ran a forward process to get a noisy image then ran the iterative_denoise_cfg function from the previous step using a starting index in [1, 3, 5, 7, 10, 20]. This “edits” the image gradually into the original image. <br/><br/>3 Examples with conditional prompt being “a high quality photo” and unconditional prompt “”: <br/></p><p id="144fb006-dea9-8012-8281-c7b41005d373" class="">Example 1 with campanile original image: </p><div id="143fb006-dea9-800f-85e4-ecff48dfc793" class="column-list"><div id="143fb006-dea9-800f-b869-c696ae6b879f" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8037-ae61-f4f691e0dafe" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2024.png"><img style="width:288px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2024.png"/></a></figure></div><div id="143fb006-dea9-8094-b739-f0dc421e778b" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80f1-8f7b-df409933355a" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2025.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2025.png"/></a></figure></div><div id="143fb006-dea9-801d-8ea0-f2a6df3bcc52" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80b7-bedd-f584f421b364" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2026.png"><img style="width:240px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2026.png"/></a></figure></div><div id="143fb006-dea9-8043-a6e3-e50633e82385" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8017-89d6-ded1638fdcc9" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2027.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2027.png"/></a></figure></div><div id="143fb006-dea9-80a7-87c3-d76eac5b3e7e" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80e8-916c-d9b877d4cc51" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2028.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2028.png"/></a></figure></div><div id="143fb006-dea9-803c-8d05-c93bc069d3fb" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-8073-b4a5-cd6de434f03d" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2029.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2029.png"/></a></figure></div><div id="143fb006-dea9-8077-80e8-f90d69c1b4a8" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-806b-bca4-d6af16db48ac" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2015.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2015.png"/></a></figure></div></div><hr id="144fb006-dea9-801d-ad9a-c74d5baa0135"/><p id="144fb006-dea9-80ab-9fd5-e3069c5ab3f9" class="">Example 2 with minion original image: </p><div id="143fb006-dea9-800e-9744-fd65d684dc57" class="column-list"><div id="143fb006-dea9-80b6-b5a1-ec00563f173b" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80ae-b0f0-e4eeb07f8436" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2030.png"><img style="width:192px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2030.png"/></a></figure></div><div id="143fb006-dea9-8062-85b1-cddc78a5e8c4" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80cc-80a9-d8d824e5ca75" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2031.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2031.png"/></a></figure></div><div id="143fb006-dea9-80f4-99ef-e4756cb0e8c8" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8081-ad81-daf2fe2be4ec" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2032.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2032.png"/></a></figure></div><div id="143fb006-dea9-8036-b1d5-dc92d7e743d6" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8000-a2f9-e7c1b9825dcb" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2033.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2033.png"/></a></figure></div><div id="143fb006-dea9-8018-82b0-fc9e2b3e33ce" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80a4-8896-c625dd49f88a" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2034.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2034.png"/></a></figure></div><div id="143fb006-dea9-80c0-b960-eb72438db251" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-800e-bc21-dc6ebce988d0" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2035.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2035.png"/></a></figure></div><div id="143fb006-dea9-80f6-aefe-c0550074e372" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-80b9-9964-eb3b5ab02469" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2036.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2036.png"/></a></figure></div></div><hr id="144fb006-dea9-80c5-968c-f00e5dbc2ee3"/><p id="144fb006-dea9-80e5-98fa-ecb3a1c56c43" class="">Example 3 with dog original image: </p><div id="143fb006-dea9-8000-b107-f73bdc602f22" class="column-list"><div id="143fb006-dea9-80b1-9989-c79c6b8c84b0" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80b0-b376-e685bf2eb6df" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2037.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2037.png"/></a></figure></div><div id="143fb006-dea9-80ed-a6c7-eccc718f9ccd" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8067-abc8-f28a37cb7e61" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2038.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2038.png"/></a></figure></div><div id="143fb006-dea9-807c-8c5e-d7a3cddbe0f7" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8002-8e2c-e2c7180dcecc" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2039.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2039.png"/></a></figure></div><div id="143fb006-dea9-80f9-9126-c55daf595164" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80fe-82a0-f8c2618b5044" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2040.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2040.png"/></a></figure></div><div id="143fb006-dea9-806e-bb38-cfb7469e11c1" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80c2-b816-d104786a8b74" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2041.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2041.png"/></a></figure></div><div id="143fb006-dea9-80e3-9e19-d19b7c7ef33f" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-809a-a6b6-d1925b94600c" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2042.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2042.png"/></a></figure></div><div id="143fb006-dea9-80db-b357-e9f9b2afe45f" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-803f-b23a-fe85dca4c7fa" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2043.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2043.png"/></a></figure></div></div><p id="144fb006-dea9-80a3-88b0-e8638e4693d8" class="">
</p><h2 id="144fb006-dea9-807d-b008-c688291f14a3" class=""><strong>1.7.1 Editing Hand-Drawn and Web Images</strong></h2><p id="144fb006-dea9-802f-a196-c4fafdd7db0e" class="block-color-gray_background">SDEdit algorithm works even better for nonrealistic images such as paintings or a sketch, so in this section we will apply it to such. We will start with a nonrealistic image and project it onto the natural image manifold. I used the staff provided solution to generate a web image (the avocado) and to create my own sketch (the shark and house).<br/><br/></p><p id="144fb006-dea9-8062-9fc8-e0261ec60de3" class="">Example with web image: </p><div id="143fb006-dea9-8076-8406-c1605eeffb93" class="column-list"><div id="143fb006-dea9-8090-b8c0-dff63704432b" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80e3-92cc-c40f20bbeaaa" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2044.png"><img style="width:192px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2044.png"/></a></figure></div><div id="143fb006-dea9-805f-bbe6-dfaf281d80c3" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80f0-9876-fb1546f330a7" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2045.png"><img style="width:288px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2045.png"/></a></figure></div><div id="143fb006-dea9-80b2-8f6b-f1cc2e5240cc" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80f1-b827-cf36716dfac1" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2046.png"><img style="width:240px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2046.png"/></a></figure></div><div id="143fb006-dea9-80c3-9996-e3bfec488dbe" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8007-9cea-f0725036d230" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2047.png"><img style="width:240px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2047.png"/></a></figure></div><div id="143fb006-dea9-802a-ba2d-dad020e04888" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80d1-93f5-dae9415babbb" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2048.png"><img style="width:240px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2048.png"/></a></figure></div><div id="143fb006-dea9-80be-a6cf-e222a17d2eae" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-8010-948c-f7cf669b4534" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2049.png"><img style="width:336px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2049.png"/></a></figure></div><div id="143fb006-dea9-80a1-bae5-e84f08e0cdf2" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-8031-b681-d1d3dcbd9219" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2050.png"><img style="width:240px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2050.png"/></a></figure></div></div><hr id="144fb006-dea9-8015-8fb2-f14f33076541"/><p id="144fb006-dea9-806a-b69a-c6834bfaeb1b" class="">Example 1 with hand drawn image of a shark: </p><div id="143fb006-dea9-801d-840d-ce32b9322f1f" class="column-list"><div id="143fb006-dea9-80d7-9d41-ff9273d17b0d" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80fa-9f65-d6702f5c7087" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2051.png"><img style="width:288px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2051.png"/></a></figure></div><div id="143fb006-dea9-8074-9656-f7f80ba6f03d" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8008-b1a9-f805e00994e6" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2052.png"><img style="width:288px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2052.png"/></a></figure></div><div id="143fb006-dea9-804c-97f6-eaa59f8bf0d0" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8047-af87-cd67d4137ac8" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2053.png"><img style="width:240px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2053.png"/></a></figure></div><div id="143fb006-dea9-804b-831f-dfcbb579c714" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-801f-a241-fa87bf701e0e" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2054.png"><img style="width:288px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2054.png"/></a></figure></div><div id="143fb006-dea9-8065-9d93-dfead0ac86fb" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-806d-8944-d4b5aff5d435" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2055.png"><img style="width:240px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2055.png"/></a></figure></div><div id="143fb006-dea9-80db-a211-d37194f0b155" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-80b8-9549-e400a7352767" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2056.png"><img style="width:288px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2056.png"/></a></figure></div><div id="143fb006-dea9-8018-901e-ec74bfe2948f" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-80f5-b455-c9c07d9738ce" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2057.png"><img style="width:192px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2057.png"/></a></figure></div></div><hr id="144fb006-dea9-8063-a817-e3119975abf5"/><p id="144fb006-dea9-8065-978f-db4ce8b92d61" class="">Example 2 with hand drawn image of a house: </p><div id="143fb006-dea9-8003-ac94-db0ef58d9563" class="column-list"><div id="143fb006-dea9-8060-9960-e900a53bf437" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8037-93fc-de4b6f1159bb" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2058.png"><img style="width:384px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2058.png"/></a></figure></div><div id="143fb006-dea9-8048-be80-e1f8db258b5a" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80e8-893e-f08f3fa61ec1" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2059.png"><img style="width:480px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2059.png"/></a></figure></div><div id="143fb006-dea9-80de-9b12-cee31d54e2e7" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-804a-b53f-d55e61f1ea35" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2060.png"><img style="width:432px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2060.png"/></a></figure></div><div id="143fb006-dea9-8055-8f01-f7f127462630" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8065-b34a-f086c5c0f62e" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2061.png"><img style="width:336px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2061.png"/></a></figure></div><div id="143fb006-dea9-807b-86e5-c2aeb17b6172" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80e6-8fe2-dca57de536e6" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2062.png"><img style="width:288px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2062.png"/></a></figure></div><div id="143fb006-dea9-80ce-b1f0-d97ba12dfb82" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-80c7-a12c-fbc427469ec7" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2063.png"><img style="width:240px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2063.png"/></a></figure></div><div id="143fb006-dea9-80e5-a3fd-c0aee49a9963" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-80c2-8c1c-dfbb1dfa40a0" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2064.png"><img style="width:240px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2064.png"/></a></figure></div></div><hr id="144fb006-dea9-80e8-90ec-f948c7d5a78a"/><h2 id="144fb006-dea9-804f-862e-ece79f86db87" class=""><strong>1.7.2 Inpainting</strong></h2><p id="144fb006-dea9-80f9-a49f-f8694a2e6165" class="block-color-gray_background">We can do the same thing to fill in a section of an image. Here we take an image <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>o</mi><mi>r</mi><mi>i</mi><mi>g</mi><mi>i</mi><mi>n</mi><mi>a</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{original}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">or</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span><span class="mord mathnormal mtight">ina</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and a binary mask <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span><span>﻿</span></span>, we then create a new image that preserves the original imae where <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span><span>﻿</span></span> is 0 or black and creates new image content where <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span></span><span>﻿</span></span> is 1 or white. To do this we do the same diffusion denoising loop as previously but manually force the same pixels in the output image as the input where the mask is 0, and just apply the newly generated image to where the mask is 1. <br/><br/></p><p id="144fb006-dea9-8037-8b8c-d32c717823f4" class="">Example images with 2 different outputs:</p><div id="143fb006-dea9-80de-8e22-c2f1563c2e3d" class="column-list"><div id="143fb006-dea9-80c3-b6e3-df36cf023b83" style="width:20%" class="column"><p id="144fb006-dea9-8073-9399-f7df1b6a3c37" class="">Original Images</p><hr id="144fb006-dea9-8078-bffc-f5fa0e7c331d"/><figure id="143fb006-dea9-8021-aaf7-e9923f642c3e" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2065.png"><img style="width:480px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2065.png"/></a></figure></div><div id="143fb006-dea9-8049-a66a-e4de1620219a" style="width:20%" class="column"><p id="144fb006-dea9-80fb-8c5a-e9d7b7567721" class="">Mask</p><hr id="144fb006-dea9-807d-8864-f33452400186"/><figure id="143fb006-dea9-801d-a64c-e30e04bd40da" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2066.png"><img style="width:432px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2066.png"/></a></figure></div><div id="143fb006-dea9-80b9-ae1c-e5ff6b020b7b" style="width:20%" class="column"><p id="144fb006-dea9-80f1-bc99-f0e84c191f65" class="">Hole to Fill</p><hr id="144fb006-dea9-809a-88ef-d109d239cb06"/><figure id="143fb006-dea9-80d1-b8d5-dcfe2bcbd2f5" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2067.png"><img style="width:624px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2067.png"/></a></figure></div><div id="143fb006-dea9-80d2-9af1-f8e3a72b9b80" style="width:20%" class="column"><p id="144fb006-dea9-805e-bc9e-ff3b76fae5db" class="">Inpainted example 1</p><hr id="144fb006-dea9-803d-b201-e843b84556e3"/><figure id="143fb006-dea9-809d-93d3-cf9ce97495c1" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/656332c6-f175-40dc-84a0-37efe0145007.png"><img style="width:325.86387434554973px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/656332c6-f175-40dc-84a0-37efe0145007.png"/></a></figure></div><div id="143fb006-dea9-80d5-948b-eb5977711589" style="width:20%" class="column"><p id="144fb006-dea9-8053-9650-cced53ba8692" class="">Inpainted example 1</p><hr id="144fb006-dea9-805a-8a5d-cc0ac03bcbcd"/><figure id="143fb006-dea9-8087-a0af-caf4f261978a" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/5445e650-4810-4674-b9b8-b4e9ff06354b.png"><img style="width:323.32467532467535px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/5445e650-4810-4674-b9b8-b4e9ff06354b.png"/></a></figure></div></div><hr id="144fb006-dea9-806a-adc6-e4777620ad4f"/><div id="143fb006-dea9-80ba-a250-e5ffdc3a3687" class="column-list"><div id="143fb006-dea9-8037-812b-c13fd59aef7b" style="width:20%" class="column"><figure id="143fb006-dea9-8089-990a-fb961d9a0775" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2068.png"><img style="width:864px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2068.png"/></a></figure></div><div id="143fb006-dea9-800f-9284-fd238ecfdd3e" style="width:20%" class="column"><figure id="143fb006-dea9-80ba-8a9c-eabd92548ea3" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2069.png"><img style="width:672px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2069.png"/></a></figure></div><div id="143fb006-dea9-80e3-b548-fcdbdce9f92d" style="width:20%" class="column"><figure id="143fb006-dea9-8080-af78-cd6e6b738cc5" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2070.png"><img style="width:528px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2070.png"/></a></figure></div><div id="143fb006-dea9-80de-a645-e6f47d5b56af" style="width:20%" class="column"><figure id="143fb006-dea9-80c9-9ac6-e11ade34c139" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/a4c36e12-2e43-427f-a7b8-06dd07700802.png"><img style="width:192px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/a4c36e12-2e43-427f-a7b8-06dd07700802.png"/></a></figure></div><div id="143fb006-dea9-80c7-ba02-ec75eeb143ef" style="width:20%" class="column"><figure id="143fb006-dea9-8013-8a92-e394bfee1fcf" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/38474326-3b63-4c7d-a647-03443c1a0d27.png"><img style="width:336px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/38474326-3b63-4c7d-a647-03443c1a0d27.png"/></a></figure></div></div><hr id="144fb006-dea9-805b-bf01-ed622e668438"/><div id="143fb006-dea9-80f2-bf35-df7c7585e140" class="column-list"><div id="143fb006-dea9-80de-87e7-c13a270d69a1" style="width:20%" class="column"><figure id="143fb006-dea9-80df-b50c-e781b94d805b" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2071.png"><img style="width:720px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2071.png"/></a></figure></div><div id="143fb006-dea9-8038-ace7-fee1f4e20078" style="width:20%" class="column"><figure id="143fb006-dea9-8074-949e-d16725e7801a" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2072.png"><img style="width:528px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2072.png"/></a></figure></div><div id="143fb006-dea9-806c-98a8-d1b1a380681e" style="width:20%" class="column"><figure id="143fb006-dea9-8076-b269-d22f2c14e943" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2073.png"><img style="width:384px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2073.png"/></a></figure></div><div id="143fb006-dea9-8047-a262-e16911fa5a95" style="width:20%" class="column"><figure id="143fb006-dea9-80b6-b8af-ef6363895b0f" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/fcd78222-0df1-46ab-a5ef-f51231ff383f.png"><img style="width:324.16666666666663px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/fcd78222-0df1-46ab-a5ef-f51231ff383f.png"/></a></figure></div><div id="143fb006-dea9-80d5-bc59-cb58c13fd8e3" style="width:20%" class="column"><figure id="143fb006-dea9-804f-81a9-f81313963692" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/7ab582d9-6d78-437e-9852-e4256751c8b6.png"><img style="width:324.16666666666663px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/7ab582d9-6d78-437e-9852-e4256751c8b6.png"/></a></figure></div></div><hr id="144fb006-dea9-8090-b845-cd53194b78f6"/><h2 id="144fb006-dea9-8042-877b-ddeff843c2b5" class=""><strong>1.7.3 Text-Conditional Image-to-image Translation</strong></h2><p id="144fb006-dea9-807b-a7d4-c9a3eaca353d" class="block-color-gray_background">Now we do the same thing as 1.7.2 but instead guide the projection with a text prompt.<br/>Examples below where the rightmost image is the original passed in image. <br/></p><p id="144fb006-dea9-80ce-a694-ddad11c4b98d" class="">Example with prompt &quot;a rocket ship”: </p><div id="143fb006-dea9-807e-95b4-fa08473cb7d1" class="column-list"><div id="143fb006-dea9-8025-9970-e089479399ef" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80ad-8d87-fe6829db7643" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2074.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2074.png"/></a></figure></div><div id="143fb006-dea9-8065-b880-fc41fc5db2c8" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-8076-b8c0-d31748921ac5" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2075.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2075.png"/></a></figure></div><div id="143fb006-dea9-807c-964a-dca40238e783" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80de-9f6d-fac59097aa0e" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2076.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2076.png"/></a></figure></div><div id="143fb006-dea9-8095-911a-d9351e8183b8" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8060-947a-cf6af39c125a" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2077.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2077.png"/></a></figure></div><div id="143fb006-dea9-804d-aae3-de608879600e" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8016-9668-ed45db6f6e3a" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2078.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2078.png"/></a></figure></div><div id="143fb006-dea9-8053-82f8-f09b0616da77" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80b7-accd-c72da41aa794" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2079.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2079.png"/></a></figure></div><div id="143fb006-dea9-80ee-bdf3-ce05dcca29a8" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-8086-a49c-d500aaad5376" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2015.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2015.png"/></a></figure></div></div><hr id="144fb006-dea9-8019-b249-c26d5f137396"/><p id="144fb006-dea9-80ec-834b-ce77e89afc76" class="">Example with prompt &quot;a  photo of a man”: </p><div id="143fb006-dea9-8068-92d9-e314145acc9e" class="column-list"><div id="143fb006-dea9-8012-9f94-e9cd32e49e8a" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8029-ac79-d0f7207390d5" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2080.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2080.png"/></a></figure></div><div id="143fb006-dea9-80c5-8bbe-c64fabeb8a02" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8080-9f46-df876d695e21" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2081.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2081.png"/></a></figure></div><div id="143fb006-dea9-8040-b5d5-ee511d18ed20" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-80ac-b072-dddc71e43cfd" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2082.png"><img style="width:240px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2082.png"/></a></figure></div><div id="143fb006-dea9-8020-80c0-efc6cfdfd9d0" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80c1-9dda-dd1448325989" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2083.png"><img style="width:389.0017395019531px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2083.png"/></a></figure></div><div id="143fb006-dea9-8037-a025-e12739b5bc29" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-805c-81f7-cb694b20688f" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2084.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2084.png"/></a></figure></div><div id="143fb006-dea9-8031-9b34-e98cb8e7a51d" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8046-89ec-dc1f0c2021d1" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2085.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2085.png"/></a></figure></div><div id="143fb006-dea9-80ea-accd-efb22816ca81" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-809c-a85c-d4e714c66d41" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2086.png"><img style="width:288px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2086.png"/></a></figure></div></div><hr id="144fb006-dea9-80c2-a257-e332238d2c57"/><p id="144fb006-dea9-8025-9efe-c936bb49902c" class="">Example with prompt &quot;a photo of a dog”: </p><div id="143fb006-dea9-80c6-9327-e4938cf26d67" class="column-list"><div id="143fb006-dea9-80cf-8ced-e35321da2cd1" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8001-8f16-ff5cd2cd2aeb" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2087.png"><img style="width:288px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2087.png"/></a></figure></div><div id="143fb006-dea9-8057-9fdb-c3dd4a786ccf" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-80e7-9481-e2579b3791cd" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2088.png"><img style="width:389.0017395019531px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2088.png"/></a></figure></div><div id="143fb006-dea9-808c-bfb3-c11e62a36c3d" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-809c-ad98-e7691bf6b638" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2089.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2089.png"/></a></figure></div><div id="143fb006-dea9-800f-8ffb-f20e1bd12bf0" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8012-98da-c0691732a24d" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2090.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2090.png"/></a></figure></div><div id="143fb006-dea9-808b-bb19-f2848e5a4f11" style="width:14.285714285714288%" class="column"><figure id="143fb006-dea9-8060-bbad-d9bc3bc50e9b" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2091.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2091.png"/></a></figure></div><div id="143fb006-dea9-8012-809e-c2c00d2a6568" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-8097-9496-daa036b9ad61" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2092.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2092.png"/></a></figure></div><div id="143fb006-dea9-80ae-b6e4-d3adab4e155a" style="width:14.285714285714285%" class="column"><figure id="143fb006-dea9-8048-a7ce-e5a9815f02c0" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2043.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2043.png"/></a></figure></div></div><h2 id="144fb006-dea9-80d9-8226-ebb9c5b35d81" class=""><strong>1.8 Visual Anagrams</strong></h2><p id="144fb006-dea9-8075-913f-e7ba6a3fb5d0" class="block-color-gray_background">Here we will create visual anagrams with diffusion models. So that two interpretations of an image are on one image just flipped.  We denoise an image using the first text prompt to obtain the first noise estimate <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\epsilon_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> and also denoise that image flipped upside down with the second prompt to obtain a second noise estimate <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\epsilon_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. We then simply slip <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\epsilon_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> back and average the two noise estimates. And then do the same denoising diffusion step just with this averaged noise estimate instead.</p><p id="144fb006-dea9-80cc-9136-f4a90e699dfe" class="">
</p><p id="144fb006-dea9-80e5-be9c-c500d331abe7" class="">Two outputted examples using prompts “an oil painting of people around a campfire” and “an oil painting of an old man”: </p><div id="144fb006-dea9-8072-89fd-d721c7677f3f" class="column-list"><div id="144fb006-dea9-8056-b3e8-d261c3335dbb" style="width:25%" class="column"><figure id="143fb006-dea9-80f9-af73-d4fe78be0669" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2093.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2093.png"/></a></figure></div><div id="144fb006-dea9-8074-b384-e1ba8db9a864" style="width:25%" class="column"><figure id="143fb006-dea9-800d-a405-fe7c0f790c97" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2094.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2094.png"/></a></figure></div><div id="144fb006-dea9-8047-bf56-cffad9649551" style="width:25%" class="column"><figure id="143fb006-dea9-806a-b23d-d460f16e577a" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2095.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2095.png"/></a></figure></div><div id="144fb006-dea9-8046-853e-e632045f4844" style="width:25%" class="column"><figure id="143fb006-dea9-80b8-a4c2-ee02b4ba1597" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2096.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2096.png"/></a></figure></div></div><hr id="144fb006-dea9-8056-ac8a-fa2b74f4a13e"/><div id="144fb006-dea9-8087-9ad8-ee88234ee9b1" class="column-list"><div id="144fb006-dea9-8011-9bcb-d5ed9f9f1b9b" style="width:50%" class="column"><p id="144fb006-dea9-80fa-b59f-fdf7959ece43" class="">Example with prompts “a photo of the amalfi cost” and “an oil painting of a snowy mountain village”: </p></div><div id="144fb006-dea9-80cf-98d2-d58cff42d0be" style="width:50%" class="column"><p id="144fb006-dea9-801d-a337-e9933ac6960f" class="">Example with prompts “a photo of an old woman” and “a dress”: </p></div></div><div id="143fb006-dea9-8006-bcc3-c467ccea0dea" class="column-list"><div id="143fb006-dea9-803f-9a99-eded5e1df4b5" style="width:25%" class="column"><figure id="143fb006-dea9-8072-bdd2-c979cf39c2b0" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2097.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2097.png"/></a></figure></div><div id="143fb006-dea9-80fc-90a5-dfd68abbfdb1" style="width:25%" class="column"><figure id="143fb006-dea9-8006-9e08-d0e33c7144b2" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2098.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2098.png"/></a></figure></div><div id="144fb006-dea9-80f7-96f3-eb896610fc71" style="width:25%" class="column"><figure id="143fb006-dea9-800b-ac52-c889371320f6" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2099.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%2099.png"/></a></figure></div><div id="144fb006-dea9-800b-87e2-c3cfc0c9094e" style="width:25%" class="column"><figure id="143fb006-dea9-80fa-8b5c-e677e37b2da9" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20100.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20100.png"/></a></figure></div></div><h2 id="144fb006-dea9-80b3-ae04-f38d008353df" class=""><strong>1.9 Hybrid Images</strong></h2><p id="144fb006-dea9-809e-80a1-e1046b609f5a" class="block-color-gray_background">In this section we will create hybrid images where you see the high frequencies of one image and low of another. This makes you see one thing upclose and another afar. This is done with Factorized Diffusion. A similar technique is used to create hybrid images as visual anagrams. we create 2 noise estimates with 2 prompts, then we simply add the low frequencies of one image to the high frequencies of another. To get the low frequencies of a noise estimate we simply pass in the noise estimate to torchvision.transforms.functional.gaussian_blur. I used a kernel size of 33 and sigma of 2. <br/><br/></p><p id="144fb006-dea9-8061-8090-e7de852bce50" class="">Example images: </p><div id="143fb006-dea9-8099-ba8c-f47554e1025f" class="column-list"><div id="143fb006-dea9-8067-bcf9-d74dc39a56c3" style="width:37.5%" class="column"><figure id="143fb006-dea9-8054-908d-d48357bcbc3b" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20101.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20101.png"/></a></figure></div><div id="143fb006-dea9-80de-b5ac-e5b5e3906bcf" style="width:12.500000000000004%" class="column"><figure id="143fb006-dea9-80b8-83e0-f17f045b05cb" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20102.png"><img style="width:120px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20102.png"/></a></figure><p id="144fb006-dea9-8039-b63f-c727c4e53fac" class="">
</p></div><div id="144fb006-dea9-80dd-819b-dbf73f36d9d2" style="width:37.5%" class="column"><figure id="144fb006-dea9-801b-bb55-fb8543914a75" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20103.png"><img style="width:388.9930725097656px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20103.png"/></a></figure></div><div id="144fb006-dea9-80ad-ab33-d3b708475ed7" style="width:12.499999999999998%" class="column"><figure id="144fb006-dea9-80b2-8e1a-e53cc10d37ac" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20104.png"><img style="width:132px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20104.png"/></a></figure><p id="144fb006-dea9-8096-ab7b-cc2b6d7c39b9" class="">
</p></div></div><div id="144fb006-dea9-8043-80d9-c3914e651aee" class="column-list"><div id="144fb006-dea9-80e9-89a0-c67ef231dee1" style="width:50%" class="column"><figure id="144fb006-dea9-8084-94ed-e6ed59a4bea6" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20105.png"><img style="width:623.984375px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20105.png"/></a></figure></div><div id="144fb006-dea9-8077-8194-ff803d1b652a" style="width:50%" class="column"><figure id="144fb006-dea9-8072-8fb3-fca9091316c2" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20106.png"><img style="width:240px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20106.png"/></a></figure><p id="144fb006-dea9-8052-9e63-d3b4eeb181dd" class="">
</p></div></div><p id="144fb006-dea9-8022-b40a-d135a7092f7f" class="">
</p><h2 id="144fb006-dea9-802c-9b9b-e51833537918" class="">Part B: </h2><h2 id="144fb006-dea9-80e2-9415-c39c4570d7cb" class=""><strong>Part 1: Training a Single-Step Denoising UNet</strong></h2><p id="144fb006-dea9-8068-a212-e98a1ff6ae1f" class="">We will create a one step denoiser in part 1. We will train the denoiser <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">D_{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> to match a noisy image <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></span><span>﻿</span></span> to a clean one <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span>, by optimizing over L2 loss:</p><p id="144fb006-dea9-8008-b445-e57ca2019d13" class=""> <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><msub><mi>E</mi><mrow><mi>z</mi><mo separator="true">,</mo><mi>x</mi></mrow></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>D</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mi>x</mi><mi mathvariant="normal">∣</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">L = E_{z,x}||D_{\theta}(z) -x||^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">∣∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> </p><h2 id="144fb006-dea9-801c-8985-ca188e3c050d" class=""><strong>1.1 Implementing the UNet</strong></h2><p id="144fb006-dea9-8031-89df-c995c403c6f3" class="">The denoiser will be implemented as a UNet, like the one from part a. It will take an image with some noise and ouptut a denoised image of a digit. The MNIST dataset has 28x28 pixels. </p><figure id="144fb006-dea9-8072-aa3b-c5eec5444df2" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20107.png"><img style="width:864px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20107.png"/></a><figcaption>Figure 1: Unconditional UNet</figcaption></figure><figure id="144fb006-dea9-80da-9393-eebd8e2c2d02" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20108.png"><img style="width:912px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20108.png"/></a><figcaption>Figure 2: Standard UNet Operations</figcaption></figure><h2 id="144fb006-dea9-80ed-9882-ceded7fc8d38" class=""><strong>1.2 Using the UNet to Train a Denoiser</strong></h2><p id="144fb006-dea9-801f-8059-e6c1d2c9b841" class="">We need to first train our denoiser on data pairs of the noisy data and clean data, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>z</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(z, x) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>. Where <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>x</mi><mo>+</mo><mi>σ</mi><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">z = x + \sigma\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="mord mathnormal">ϵ</span></span></span></span></span><span>﻿</span></span> and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span><span>﻿</span></span> ~ <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(0, I)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>. Here we visualized the noising process over <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span></span><span>﻿</span></span>=[0, .2, .4, .5, .6, .8,1]</p><figure id="143fb006-dea9-80d3-97ef-e8e8e293ecb8" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20109.png"><img style="width:912px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20109.png"/></a><figcaption>Figure 3: Varying levels of noise on MNIST digits</figcaption></figure><h2 id="145fb006-dea9-80ae-954a-fa63aebabb95" class=""><strong>1.2.1 Training</strong></h2><p id="145fb006-dea9-80d1-9c2d-c42f38f68b9a" class="">we now train the model for denoising using <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span></span><span>﻿</span></span> = 0.5 on a clean image. We use the MNIST dataset to get the training and test sets. We use the batch size 256, over dataset of 5 epocks. We will use our UNet architecture with hidden dimensions D=128. We will use the adam optimizer with learning rate of 1e-4.</p><figure id="144fb006-dea9-8052-90e7-cf58045ea9a8" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20110.png"><img style="width:576px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20110.png"/></a><figcaption>Figure 4: Training Loss Curve</figcaption></figure><div id="145fb006-dea9-8024-930d-fcd2bdd4f0c2" class="column-list"><div id="145fb006-dea9-80c7-a6c0-f9af710cca25" style="width:50%" class="column"><figure id="143fb006-dea9-805f-8b79-f93275780897" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20111.png"><img style="width:1239.9913330078125px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20111.png"/></a><figcaption>Figure 5: Results on digits from the test set after 1 epoch of training</figcaption></figure></div><div id="145fb006-dea9-800b-80a1-e7953cbbe656" style="width:50%" class="column"><figure id="143fb006-dea9-8021-9013-df508578a8cf" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20112.png"><img style="width:1344px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20112.png"/></a><figcaption>Figure 6: Results on digits from the test set after 5 epochs of training</figcaption></figure></div></div><h2 id="145fb006-dea9-80c3-8ceb-d78952f08e08" class=""><strong>1.2.2 Out-of-Distribution Testing </strong></h2><p id="145fb006-dea9-80b5-a76f-ce0bc0915223" class="">From the previous section, our denoiser is trained with <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span></span></span></span></span><span>﻿</span></span>=0.5, so we will see how well it does with other sigma values. Below are outputs of the denoiser on the test set with different sigma values. </p><figure id="144fb006-dea9-80fa-b0ae-f31ea8b890bd" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20113.png"><img style="width:1239.9739990234375px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20113.png"/></a><figcaption>Figure 7: Results on digits from the test set with varying noise levels.</figcaption></figure><h2 id="145fb006-dea9-8032-903b-ec5725342c56" class="">Part 2: Training a Diffusion Model</h2><p id="145fb006-dea9-80f5-a59d-c7afb8af4878" class="">Now we are going to train UNet model to iteratively denoise an image (DDP implementation). We will change UNet to predict added noise <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span><span>﻿</span></span> instead of the clean image <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>﻿</span></span>:  </p><p id="145fb006-dea9-8027-8748-ea89bfa2a45b" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><mi mathvariant="double-struck">E</mi><mrow><mi>ϵ</mi><mo separator="true">,</mo><mi>z</mi></mrow><mi mathvariant="normal">∥</mi><msub><mi>ϵ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>−</mo><mi>ϵ</mi><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">L = \mathbb{E}{\epsilon,z} \|\epsilon_{\theta}(z) - \epsilon\|^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">E</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϵ</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> , <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">\epsilon_{\theta}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is UNet trained noise prediction. We want to sample pure noise <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span><span>﻿</span></span> ~ <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(0,I) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> and iteratively denoise to generate an image x. We will use timesteps to denoise with the same equation as earlier:  <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub><mo>=</mo><msqrt><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></msqrt><msub><mi>x</mi><mn>0</mn></msub><mo>+</mo><msqrt><mrow><mn>1</mn><mo>−</mo><msub><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover><mi>t</mi></msub></mrow></msqrt><mi>ϵ</mi><mspace width="1em"/><mtext>where </mtext><mi>ϵ</mi><mo>∼</mo><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">x_t = \sqrt{\bar\alpha_t} x_0 + \sqrt{1 - \bar\alpha_t} \epsilon
\quad \text{where}~ \epsilon \sim N(0, 1).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.2461em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7939em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7539em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2461em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.2078em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8322em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7922em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2078em;"><span></span></span></span></span></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">where</span></span><span class="mspace nobreak"> </span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span><span>﻿</span></span> We use the staff provided derivation to build list <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>α</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{\alpha}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5678em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.5678em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> for all timesteps from 0 to T, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></span><span>﻿</span></span>, and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></span><span>﻿</span></span>. we will use T=300. We will condition a single UNet with timestep t, so our loss func is <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>ϵ</mi><mo separator="true">,</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo><mi>t</mi></mrow></msub><mi mathvariant="normal">∥</mi><msub><mi>ϵ</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>−</mo><mi>ϵ</mi><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">L = \mathbb{E}_{\epsilon,x_0,t} \|\epsilon_{\theta}(x_t, t) -    \epsilon\|^2.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ϵ</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϵ</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span><span>﻿</span></span></p><h2 id="145fb006-dea9-8024-b3fb-cb7e7355e498" class="">2.1 Adding Time Conditioning to UNet</h2><p id="145fb006-dea9-800e-b243-de117c0e9666" class="">We will now adjest our UNet model to include stalar t. The FCBlock (fully-connected block) for the conditioning signal. Linear(F_in, F_out) is a linear layer with F_in input features and F_out output features.    </p><figure id="145fb006-dea9-80bd-be9c-d17076832009" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20114.png"><img style="width:864px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20114.png"/></a><figcaption>Figure 8: Conditioned UNEt</figcaption></figure><figure id="145fb006-dea9-802b-bb09-cc8e732628bf" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20115.png"><img style="width:864px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20115.png"/></a><figcaption>Figure 9: FCBlock for conditioning</figcaption></figure><p id="145fb006-dea9-80ad-9322-da433893a2ba" class="">
</p><h2 id="145fb006-dea9-807c-9d74-ee630b244041" class="">2.2 Training the UNet</h2><p id="145fb006-dea9-80ad-a229-e165ff124cf7" class="">To train we now pick a random image from the training set and a random t, and we train the denoiser to predict the noise in <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. We do this for different images and ts until the model converges. Following this pseudo code: </p><figure id="145fb006-dea9-80df-97d0-d23628b68e7e" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20116.png"><img style="width:768px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20116.png"/></a></figure><p id="145fb006-dea9-8058-9e14-d2e6b077f5af" class="">
</p><p id="145fb006-dea9-8073-8935-dd3075515d49" class="">Now we will use a hidden dimension of 64, adam opimizer with learning rate 1e-3, an exponential learning rate decay scheduler with gamma of <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.</mn><msup><mn>1</mn><mrow><mo stretchy="false">(</mo><mn>1.0</mn><mi mathvariant="normal">/</mi><mi>n</mi><mi>u</mi><mi>m</mi><mi>e</mi><mi>p</mi><mi>o</mi><mi>c</mi><mi>h</mi><mi>s</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">0.1^{(1.0/numepochs)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord">0.</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1.0/</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">oc</span><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">s</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>. Below is a plot of the training loss curve for the time-conditioned UNet over the whole training process</p><figure id="145fb006-dea9-80d7-85f1-d04672d78046" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20117.png"><img style="width:701.99658203125px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20117.png"/></a><figcaption>Figure 10: Time-Conditioned UNet training loss curve</figcaption></figure><p id="145fb006-dea9-80e9-90d2-df04fe49bb3b" class="">
</p><h2 id="145fb006-dea9-80d3-8733-f192ccee8d09" class="">2.3 Sampling from the UNet</h2><p id="145fb006-dea9-800c-a7ef-fa29d5a8fc2f" class="">We do the same sampling process as part A but we dont predict the variance, instead we use <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span></span><span>﻿</span></span>. Here is the sampling pseudo code algorithm: </p><figure id="145fb006-dea9-80bd-855e-f2690af8d0b7" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20118.png"><img style="width:720px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20118.png"/></a></figure><p id="145fb006-dea9-8086-8274-c222fe67b984" class="">Below are the sampling results for time-conditioned UNet for 5 and 20 epochs. We can see that some were not denoised that great. </p><figure id="145fb006-dea9-803f-a4e2-eed3ba6e98a4" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20119.png"><img style="width:912px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20119.png"/></a></figure><figure id="145fb006-dea9-80a2-a048-d885de7d07cd" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20120.png"><img style="width:912px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20120.png"/></a></figure><p id="145fb006-dea9-8010-9f9e-fe37cdc79014" class="">
</p><h2 id="145fb006-dea9-8019-8163-d2a02cc910ed" class="">2.4 Adding Class-Conditioning to the UNet</h2><p id="145fb006-dea9-80dd-b4ba-db3008aacfe7" class="">For better quality images and control we can condition our UNet on class of digits 0 though 9 (each class will be represented with one hot encoded vector) and also have 2 fully connected blocks to feed into our class. we will also use dropout to set the class conditioning vector c to 0 10% of the time. The algorithm for training is similar to the previous section. This section will have a conditioning vector c and unconditional generation based on probability. Below is the pseudo code  algorithm for class conditioned training </p><figure id="145fb006-dea9-8008-80ec-d8701145f966" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20121.png"><img style="width:720px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20121.png"/></a></figure><figure id="145fb006-dea9-8076-b27d-dd15197b3874" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20122.png"><img style="width:624px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20122.png"/></a></figure><h2 id="145fb006-dea9-8029-b766-c6f57af46034" class="">2.5 Sampling from the Class-Conditioned UNet</h2><p id="145fb006-dea9-80d2-9192-f4426e8cbf57" class="">This sampling process is also very similar to part A. We will also use classsifer-free guidance in this part to for better results. We will use <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>5.0</mn></mrow><annotation encoding="application/x-tex">\gamma = 5.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">5.0</span></span></span></span></span><span>﻿</span></span>. Below is the pseudo code algorithm for sampling, and my sampling results for the class-conditioned UNet for 5 and 20 epochs, with 4 instances of each digit.</p><figure id="145fb006-dea9-80a4-9447-f804feaba5e5" class="image"><a href="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20123.png"><img style="width:720px" src="COMPSCI%20180%20Project%205%20Fun%20with%20Diffusion%20Models!%20142fb006dea98029818cc2947148d8e0/image%20123.png"/></a></figure><p id="145fb006-dea9-803c-abc5-f31e27de2f7b" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>
